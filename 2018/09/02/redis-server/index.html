<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>redis-server | Boreas</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="redis-server 简单整理转载：http:&#x2F;&#x2F;www.cnblogs.com&#x2F;shanyou&#x2F;archive&#x2F;2012&#x2F;01&#x2F;28&#x2F;2330451.html转载：https:&#x2F;&#x2F;zh.wikipedia.org&#x2F;wiki&#x2F;Redis资料主要转载上个博客和维基百科， 博客中用的是redis-2.4.6目前学习的是redis-4.0.9，可能配置有些出入。redis server主要是一个数据">
<meta property="og:type" content="article">
<meta property="og:title" content="redis-server">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2018&#x2F;09&#x2F;02&#x2F;redis-server&#x2F;index.html">
<meta property="og:site_name" content="Boreas">
<meta property="og:description" content="redis-server 简单整理转载：http:&#x2F;&#x2F;www.cnblogs.com&#x2F;shanyou&#x2F;archive&#x2F;2012&#x2F;01&#x2F;28&#x2F;2330451.html转载：https:&#x2F;&#x2F;zh.wikipedia.org&#x2F;wiki&#x2F;Redis资料主要转载上个博客和维基百科， 博客中用的是redis-2.4.6目前学习的是redis-4.0.9，可能配置有些出入。redis server主要是一个数据">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-11-07T01:20:16.410Z">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="Boreas" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/myhead.jpg">
  
  <link rel="stylesheet" href="/css/style.css">
  
  

  <script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>
  <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>

  
</head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/myhead.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Taylor</a></h1>
		</hgroup>

		

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">时间轴</a></li>
				        
							<li><a href="/categories">分类</a></li>
				        
							<li><a href="/tags/">标签</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Taylor</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/myhead.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Taylor</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">时间轴</a></li>
		        
					<li><a href="/categories">分类</a></li>
		        
					<li><a href="/tags/">标签</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-redis-server" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/09/02/redis-server/" class="article-date">
  	<time datetime="2018-09-02T06:20:04.000Z" itemprop="datePublished">2018-09-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      redis-server
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Lorta/">Lorta</a>
	</div>


        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="redis-server-简单整理"><a href="#redis-server-简单整理" class="headerlink" title="redis-server 简单整理"></a>redis-server 简单整理</h1><p>转载：<a href="http://www.cnblogs.com/shanyou/archive/2012/01/28/2330451.html" target="_blank" rel="noopener">http://www.cnblogs.com/shanyou/archive/2012/01/28/2330451.html</a><br>转载：<a href="https://zh.wikipedia.org/wiki/Redis" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/Redis</a><br>资料主要转载上个博客和维基百科， 博客中用的是redis-2.4.6<br>目前学习的是redis-4.0.9，可能配置有些出入。<br>redis server主要是一个数据存储系统。用来存储数据的。</p>
<hr>
<h2 id="Redis简介"><a href="#Redis简介" class="headerlink" title="Redis简介"></a>Redis简介</h2><p> Redis是一个key-value存储系统。和Memcached类似，但是解决了断电后数据完全丢失的情况。<br> 支持更多无化的value类型，除了和string外，还支持lists（链表）、sets（集合）和zsets（有序集合）几种<strong>数据类型</strong>。这些数据类型都支持push/pop、add/remove及取交集并集和差集及更丰富的操作，而且这些操作都是原子性的。</p>
<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><p>Redis的外围由一个键、值映射的字典构成。与其他非关系型数据库主要不同在于：Redis中值的类型不仅限于字符串，还支持如下抽象数据类型：</p>
<blockquote>
<ul>
<li>字符串列表</li>
<li>无序不重复的字符串集合</li>
<li>有序不重复的字符串集合</li>
<li>键、值都为字符串的哈希表</li>
</ul>
</blockquote>
<p>值的类型决定了值本身支持的操作。Redis支持不同无序、有序的列表，无序、有序的集合间的交集、并集等高级服务器端原子操作。</p>
<h2 id="安装Redis"><a href="#安装Redis" class="headerlink" title="安装Redis"></a>安装Redis</h2><p>Redis的代码遵循ANSI-C编写，可以在所有POSIX系统（如Linux, *BSD, Mac OS X, Solaris等）上安装运行。而且Redis并不依赖任何非标准库，也没有编译参数必需添加。redis的安装出奇的简单，这可能也是他风靡的一个原因，让人很容易上手，不像某些东西，编译阶段就能让人完全绝望。</p>
<p>先去官网下载源码：<br>wget <a href="http://redis.googlecode.com/files/redis-2.4.6.tar.gz" target="_blank" rel="noopener">http://redis.googlecode.com/files/redis-2.4.6.tar.gz</a></p>
<p>解压：</p>
<blockquote>
<p>tar –zxvf redis-2.4.6.tar.gz</p>
</blockquote>
<p>编译<br>需要说明的事，redis的安装非常简单，已经有现成的Makefile文件，直接运行make命令即可。</p>
<blockquote>
<p>make<br>make install</p>
</blockquote>
<p>Ubuntu 18.04 可以使用：</p>
<blockquote>
<p>sudo pat-get install redis-server</p>
</blockquote>
<p>Redis 由四个可执行文件：<strong>redis-benchmark、redis-cli、redis-server、redis-stat</strong> 这四个文件，加上一个redis.conf就构成了整个redis的最终可用包。它们的作用如下：</p>
<p><strong>redis-server:</strong> Redis服务器的daemon启动程序<br><strong>redis-cli:</strong> Redis命令行操作工具。当然，你也可以用telnet根据其纯文本协议来操作<br><strong>redis-benchmark:</strong> Redis性能测试工具, 测试Redis在你的系统及你的配置下的读写性能<br><strong>redis-stat:</strong> Redis状态检测工具，可以检测Redis当前状态参数及延迟状况<br>现在就可以启动redis了，redis只有一个启动参数，就是他的配置文件路径。</p>
<p>redis-server /etc/redis.conf</p>
<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>注意，默认复制过去的redis.conf文件的daemonize参数为no，所以redis不会在后台运行，这时要测试，我们需要重新开一个终端。修改为yes则为后台运行redis。另外配置文件中规定了pid文件，log文件和数据文件的地址，如果有需要先修改，默认log信息定向到stdout.<br>下面是redis.conf的主要配置参数的意义：</p>
<blockquote>
<p>daemonize：是否以后台daemon方式运行<br>pidfile：pid文件位置<br>port：监听的端口号<br>timeout：请求超时时间<br>loglevel：log信息级别<br>logfile：log文件位置<br>databases：开启数据库的数量<br>save * <em>：保存快照的频率，第一个</em>表示多长时间，第三个*表示执行多少次写操作。在一定时间内执行一定数量的写操作时，自动保存快照。可设置多个条件。<br>rdbcompression：是否使用压缩<br>dbfilename：数据快照文件名（只是文件名，不包括目录）<br>dir：数据快照的保存目录（这个是目录）<br>appendonly：是否开启appendonlylog，开启的话每次写操作会记一条log，这会提高数据抗风险能力，但影响效率。<br>appendfsync：appendonlylog如何同步到磁盘（三个选项，分别是每次写都强制调用fsync、每秒启用一次fsync、不调用fsync等待系统自己同步）</p>
</blockquote>
<p>这时你可以打开一个终端进行测试了，配置文件中默认的监听端口是6379</p>
<h2 id="redis数据结构"><a href="#redis数据结构" class="headerlink" title="redis数据结构"></a>redis数据结构</h2><p>redis 的作者antirez曾称其为一个数据结构服务器（data structures server），这是一个非常准确的表述，redis的所有功能就是将数据以其固有的几种结构保存，并提供给用户操作这几种结构的接口。我们可以想象我们在各种语言中的那些固有数据类型及其操作。</p>
<p>redis目前提供<strong>四种数据类型</strong>：string,list,set及zset(sorted set)和Hash。</p>
<blockquote>
<ul>
<li>string是最简单的类型，你可以理解成与Memcached一模一个的类型，一个key对应一个value，其上支持的操作与Memcached的操作类似。但它的功能更丰富。</li>
<li>list是一个链表结构，主要功能是push、pop、获取一个范围的所有值等等。操作中key理解为链表的名字。</li>
<li>set是集合，和我们数学中的集合概念相似，对集合的操作有添加删除元素，有对多个集合求交并差等操作。操作中key理解为集合的名字。zset是set的一个升级版本，他在set的基础上增加了一个顺序属性，这一属性在添加修改元素的时候可以指定，每次指定后，zset会自动重新按新的值调整顺序。可以理解了有两列的mysql表，一列存value，一列存顺序。操作中key理解为zset的名字。</li>
<li>Hash数据类型允许用户用Redis存储对象类型,Hash数据类型的一个重要优点是,当你存储的数据对象只有很少几个key值时,数据存储的内存消耗会很小.更多关于Hash数据类型的说明请见: <a href="http://code.google.com/p/redis/wiki/Hashes" target="_blank" rel="noopener">http://code.google.com/p/redis/wiki/Hashes</a></li>
</ul>
</blockquote>
<p>在官网上给出了所有支持的接口列表，并副副附有详细的介绍，地址：<br><a href="http://code.google.com/p/redis/wiki/CommandReference" target="_blank" rel="noopener">http://code.google.com/p/redis/wiki/CommandReference</a></p>
<h2 id="redis数据存储"><a href="#redis数据存储" class="headerlink" title="redis数据存储"></a>redis数据存储</h2><p>redis的存储分为内存存储、磁盘存储和log文件三部分，配置文件中有三个参数对其进行配置。</p>
<p><strong>save seconds updates，save</strong>配置，指出在多长时间内，有多少次更新操作，就将数据同步到数据文件。这个可以多个条件配合，比如默认配置文件中的设置，就设置了三个条件。</p>
<p><strong>appendonly yes/no ，appendonly</strong> 配置，指出是否在每次更新操作后进行日志记录，如果不开启，可能会在断电时导致一段时间内的数据丢失。因为redis本身同步数据文件是按上面的save条件来同步的，所以有的数据会在一段时间内只存在于内存中。</p>
<p><strong>appendfsync no/always/everysec ，appendfsync</strong> 配置，no表示等操作系统进行数据缓存同步到磁盘，always表示每次更新操作后手动调用fsync()将数据写到磁盘，everysec表示每秒同步一次。</p>
<h2 id="支持语言"><a href="#支持语言" class="headerlink" title="支持语言"></a>支持语言</h2><p>许多语言都包含Redis支持，包括:</p>
<table>
<thead>
<tr>
<th>ActionScript</th>
<th>C</th>
<th>C++</th>
<th>Clojure</th>
</tr>
</thead>
<tbody><tr>
<td>Common Lisp</td>
<td>Dart</td>
<td>Erlang</td>
<td>Go</td>
</tr>
<tr>
<td>Haskell</td>
<td>Haxe</td>
<td>Io</td>
<td>Java</td>
</tr>
<tr>
<td>Fibjs</td>
<td>Node.js</td>
<td>Lua</td>
<td>Objective-C</td>
</tr>
<tr>
<td>Perl</td>
<td>PHP</td>
<td>Pure Data</td>
<td>Python</td>
</tr>
<tr>
<td>Ruby</td>
<td>Scala</td>
<td>Smalltalk</td>
<td>Tcl</td>
</tr>
<tr>
<td>## Python简单示例</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"></span><br><span class="line"><span class="comment"># lredis-server保持开启状态 如果在客户端设置了密码 添加password=密码即可</span></span><br><span class="line">pool = redis.ConnectionPool(host=<span class="string">'127.0.0.1'</span>, port=<span class="number">6379</span>, db=<span class="number">0</span>)</span><br><span class="line">r = redis.StrictRedis(connection_pool=pool)</span><br><span class="line"><span class="comment"># 字符串</span></span><br><span class="line">r.set(<span class="string">'test'</span>, <span class="string">'aaa'</span>)</span><br><span class="line"><span class="keyword">print</span> r.get(<span class="string">'test'</span>)</span><br><span class="line"><span class="comment"># 列表</span></span><br><span class="line"><span class="comment"># 注意python、lrange两个range的范围</span></span><br><span class="line">x = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">11</span>):</span><br><span class="line">    r.lpush(<span class="string">'list'</span>, x)</span><br><span class="line">    x = x + <span class="number">1</span></span><br><span class="line"><span class="keyword">print</span> r.lrange(<span class="string">'list'</span>, <span class="string">'0'</span>, <span class="string">'10'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 雜湊</span></span><br><span class="line">dict_hash = &#123;<span class="string">'name'</span>: <span class="string">'tang'</span>, <span class="string">'password'</span>: <span class="string">'tang_passwd'</span>&#125;</span><br><span class="line">r.hmset(<span class="string">'hash_test'</span>, dict_hash)</span><br><span class="line"><span class="keyword">print</span> r.hgetall(<span class="string">'hash_test'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 集合</span></span><br><span class="line">r.sadd(<span class="string">'set_test'</span>, <span class="string">'aaa'</span>, <span class="string">'bbb'</span>)</span><br><span class="line">r.sadd(<span class="string">'set_test'</span>, <span class="string">'ccc'</span>)</span><br><span class="line">r.sadd(<span class="string">'set_test'</span>, <span class="string">'ddd'</span>)</span><br><span class="line"><span class="keyword">print</span> r.smembers(<span class="string">'set_test'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 有序集</span></span><br><span class="line">r.zadd(<span class="string">'zset_test'</span>, <span class="string">'aaa'</span>, <span class="number">1</span>, <span class="string">'bbb'</span>, <span class="number">1</span>)</span><br><span class="line">r.zadd(<span class="string">'zset_test'</span>, <span class="string">'ccc'</span>, <span class="number">1</span>)</span><br><span class="line">r.zadd(<span class="string">'zset_test'</span>, <span class="string">'ddd'</span>, <span class="number">1</span>)</span><br><span class="line"><span class="keyword">print</span> r.zrange(<span class="string">'zset_test'</span>, <span class="number">0</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/09/05/list-tuple-dict-set/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          list, tuple, dict, set
        
      </div>
    </a>
  
  
    <a href="/2018/09/02/supervisor/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">supervisor</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>






</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2019 Taylor
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a> 
        </div>
    </div>
  </div>
</footer>

    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		particlesjs:false,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>



  </div>
</body>
</html>